;******************************************************************************
; *
; Filename: EEPROMRecordingSetup.inc *
; Date: March 21, 2025 *
; Author: Andrew Keller *
; Company: Idaho State University *
; Description: Defines registers, bits, and constants. Configures SF registers *
; Github: https://github.com/andrew1593571/RCET3375.git *
; *
;******************************************************************************
  
;***********************************************
;DEFINE GENERAL FUNCTION REGISTERS
;***********************************************
TMRCOUNT EQU H'0020'	;TIMER INTERRUPT COUNT
PCOUNT EQU H'0021'	;PLAY COUNT FOR PLAYBACK
RECMODE EQU H'0070'	;STORES THE MODE FLAGS
RCOUNT EQU H'0071'	;RECORD COUNT DURING RECORD
RECORDSTORE EQU H'0072'	;TEMPORARILY STORE RECORDED BUTTON PRESS
WSTORE EQU H'0073'	;STORE W DURING INTERRUPTS
STATUSSTORE EQU H'0074'	;STORE STATUS DURING INTERRUPTS

 
;***********************************************
;DEFINE CONSTANTS
;***********************************************
MTX_ZERO EQU H'30'	;A ZERO IN THE DOT MATRIX
MTX_ONE EQU H'31'	;A ONE IN THE DOT MATRIX
MTX_TWO EQU H'32'	;A TWO IN THE DOT MATRIX
MTX_THREE EQU H'33'	;A THREE IN THE DOT MATRIX
MTX_FOUR EQU H'34'	;A FOUR IN THE DOT MATRIX
MTX_FIVE EQU H'35'	;A FIVE IN THE DOT MATRIX
MTX_SIX EQU H'36'	;A SIX IN THE DOT MATRIX
MTX_SEVEN EQU H'37'	;A SEVEN IN THE DOT MATRIX
MTX_EIGHT EQU H'38'	;A EIGHT IN THE DOT MATRIX
MTX_NINE EQU H'39'	;A NINE IN THE DOT MATRIX
MTX_A EQU H'41'		;A IN THE DOT MATRIX
MTX_B EQU H'42'		;B IN THE DOT MATRIX
MTX_C EQU H'43'		;C IN THE DOT MATRIX
MTX_D EQU H'44'		;D IN THE DOT MATRIX
MTX_ASTERISK EQU H'2A'	;ASTERISK IN THE DOT MATRIX
MTX_POUND EQU H'23'	;POUND IN THE DOT MATRIX
MTX_S EQU H'53'		;S IN THE DOT MATRIX
MTX_R EQU H'52'		;R IN THE DOT MATRIX
TMRCOUNTRESET EQU H'0F'	;VALUE TMRCOUNT IS RESET TO

;***********************************************
;INITIALIZE PIC16F883 AND SETUP
;***********************************************

SETUP_CODE CODE	    ;START OF THE FILE
    
INITIALIZE:

;----------PORTA CONFIGURATION----------
    BANKSEL ANSEL
    MOVLW B'00000000'	;CONFIGURE PORTA ANALOG INPUTS
    MOVWF ANSEL
    
    BANKSEL TRISA
    MOVLW B'00000000'	;CONFIGURE PORTA TRISTATE BUFFER
    MOVWF TRISA
    
    BANKSEL PORTA
    CLRF PORTA		;CLEAR PORTA TO A KNOWN STATE
    
;----------PORTB CONFIGURATION----------
    BANKSEL ANSELH
    MOVLW B'00000000'	;CONFIGURE PORTB ANALOG INPUTS
    MOVWF ANSELH
    
    BANKSEL IOCB
    MOVLW B'00000000'	;CONFIGURE PORTB INTERRUPT ON CHANGE FOR EACH PIN
    MOVWF IOCB
    
    BANKSEL TRISB
    MOVLW B'11110011'	;CONFIGURE PORTB TRISTATE BUFFER
    MOVWF TRISB
    
    BANKSEL WPUB
    MOVLW B'00000000'	;CONFIGURE PORTB WEAK PULL UPS
    MOVWF WPUB
    
    BANKSEL PORTB
    CLRF PORTB		;CLEAR PORTB TO A KNOWN STATE

;----------PORTC CONFIGURATION----------
    BANKSEL TRISC
    MOVLW B'00000000'	;CONFIGURE PORTC TRISTATE BUFFER
    MOVWF TRISC
    
    BANKSEL PORTC
    CLRF PORTC		;CLEAR PORTC TO A KNOWN STATE
    
;----------INTERRUPTS CONFIGURATION----------
    MOVLW B'01000000'	    ;ENABLE PERIPHERAL INTERRUPTS
    MOVWF INTCON
    
    BANKSEL PIE1    ;ENABLE TIMER2 INTERRUPT
    MOVLW B'00000010'
    MOVWF PIE1
    
    CLRF PIE2	    ;DISABLE ALL OTHER PERIPHERAL INTERRUPTS
    
    BANKSEL PIR1    ;CLEAR ANY EXISTING PERIPHERAL FLAGS
    CLRF PIR1
    CLRF PIR2
    
;----------TIMER2 CONFIGURATION----------
    BANKSEL PR2
    MOVLW H'FF'
    MOVWF PR2		;SET TIMER2 TO ROLLOVER AT 255
    
    BANKSEL T2CON
    MOVLW B'01111010'
    MOVWF T2CON		;CONFIGURE TIMER 2, 1:16 PRE AND POST, TIMER DISABLED
    
;----------LAST STEP ENABLES----------
    BANKSEL T2CON
    BSF T2CON, TMR2ON	;ENABLE TIMER2
    BSF INTCON, GIE	;ENABLE GLOBAL INTERRUPTS
    
    BANKSEL TMRCOUNT
    MOVLW TMRCOUNTRESET
    MOVWF TMRCOUNT
    CLRF RECMODE
    
    RETURN